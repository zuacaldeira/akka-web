\begin{figure}[h]
  \centering
\begin{tikzpicture}[node distance=1.3cm,>=stealth',bend angle=45,auto]

  \tikzstyle{every node}=[circle]
  \tikzstyle{branch}=[circle, draw, minimum size=8mm]
  \tikzstyle{select}=[diamond, draw]
  \tikzstyle{transition}=[->,shorten <=1pt,>=stealthâ€™,semithick]
  \tikzstyle{pre}=[<-,shorten <=1pt,semithick]
  \tikzstyle{post}=[->,shorten >=1pt,>=stealth,semithick]
  \tikzstyle{every label}=[red]

  \begin{scope}
    % First net
\node (i)  at (0,0) [branch] {$W$};
\node (r)  [branch, right of=i] {$R$};
\node (vr) [select,right of=r] {$V_r$};
\node (l)  [branch,right of=vr] {$L$};
\node (vl) [select,right of=l] {$V_l$};
\node (u)  [branch,right of=vl] {$U$};

\path (i) edge[->, blue] (r);
\path (r) edge[->, blue] (vr);
\path (vr) edge[->, blue] (l);
\path (l) edge[->, blue] (vl);
\path (vl) edge[->, blue] (u);

\draw[blue,    post] (i) .. controls (2.2,-1) .. (l);
\draw[red,    post, dashed] (vr) .. controls (1.75,1) .. (i);
\draw[yellow, post, dashed] (vr) .. controls (1.75,0.75) .. (r);
\draw[red,    post, dashed] (vl) .. controls (3,2.2) and (2,2) .. (i);
\draw[yellow, post, dashed] (vl) .. controls (4.25,.75) .. (l);

  \end{scope}

  \begin{scope}[xshift=6cm]
    % Second net
  \end{scope}

  \begin{pgfonlayer}{background}
    \filldraw [line width=4mm,join=round,black!10]
;
%      (I.north  -| R.east)  rectangle (w2.south  -| e1.west)
%      (I'.north -| l1'.east) rectangle (w2'.south -| e1'.west);
  \end{pgfonlayer}
\end{tikzpicture}
  \caption{\code{WelcomeActor} behavior described by finite state
    machine with states $W, R, V_r, L, V_l, U$. Some states are
    represented by circles, and others represented by diamonds. Circle
    states are states were services are offered and ready to be
    consummed by clients; on diamonds states feedback is given back to
    the caller.
}
  \label{fig:sessiontype-wa}
\end{figure}








%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
